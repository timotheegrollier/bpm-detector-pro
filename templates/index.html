<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>BPM-detector</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
  </head>
  <body>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="noise"></div>

    <main class="shell">
      <header class="hero">
        <div class="eyebrow">Audio Tempo Studio</div>
        <h1>Detecteur BPM</h1>
        <p>
          Depose un fichier audio et obtiens une estimation rapide du tempo. Fonctionne avec
          MP3, WAV, FLAC, AAC, OGG et plus via <span>ffmpeg</span>.
        </p>
      </header>

      <section class="card">
        <form id="bpm-form" class="form" enctype="multipart/form-data">
          <div id="dropzone" class="dropzone" role="button" tabindex="0">
            <input id="audio" name="audio" type="file" accept="audio/*" />
            <div class="drop-copy">
              <div class="drop-title">Glisse un fichier ici</div>
              <div class="drop-sub">ou clique pour parcourir</div>
              <div id="file-name" class="file-name">Aucun fichier selectionne</div>
            </div>
          </div>

          <details class="advanced-toggle">
            <summary>Options avancées</summary>
            <div class="controls">
              <label>
                <span>Début (s)</span>
                <input type="number" step="0.1" name="start" placeholder="0" />
              </label>
              <label>
                <span>Durée (s)</span>
                <input type="number" step="0.1" name="duration" placeholder="Auto" />
              </label>
              <label>
                <span>Sample rate</span>
                <input type="number" name="sr" value="22050" />
              </label>
              <label>
                <span>BPM min</span>
                <input type="number" name="min_bpm" value="60" />
              </label>
              <label>
                <span>BPM max</span>
                <input type="number" name="max_bpm" value="200" />
              </label>
            </div>
          </details>

          <button id="submit" type="submit">
            <span class="btn-text">DÉTECTER LE BPM</span>
            <span class="btn-glow"></span>
          </button>
        </form>

        <div id="status" class="status" aria-live="polite"></div>
        <div id="result" class="result" aria-live="polite"></div>
        <div id="variations" class="variations" aria-live="polite"></div>
        <div class="hint">Taille max: {{ max_mb }} MB.</div>
      </section>

      <section class="meta">
        <div>
          <h2>Conseil rapide</h2>
          <p>
            Si le morceau change de tempo, analyse une section precise avec les champs
            <strong>Debut</strong> et <strong>Duree</strong>.
          </p>
        </div>
        <div>
          <h2>Mode rapide</h2>
          <p>
            Pour les fichiers longs, 30 a 60 secondes suffisent souvent a un bon resultat.
          </p>
        </div>
      </section>
    </main>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
  </body>
</html>
